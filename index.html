<!doctype HTML>
<html>
<head>
	<title>SCREAM The bricks</title>
	<link rel="stylesheet" href="css/style.css">
	<link rel="icon" type="image/png" href="img/ghostface.ico">
	<script src="https://code.jquery.com/jquery-3.6.3.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="sweetalert2.min.js"></script>
	<link rel="stylesheet" href="sweetalert2.min.css">
</head>
<body onload="start()">
	<audio id="brickSmash"><source src="sound/brickSmash.mp3"></audio>
	<script>
		function start(){
			Swal.fire({
			  title: 'SCREAM The Bricks',
			  text: 'You are home alone and planning on watching a horror movie. The phone rings... you decide to pick up the phone and a strange voice says: "Hello, would you like to play a game?".',
			  color:'black',
			  background:'#D3D3D3',
			  confirmButtonColor: 'rgb(133, 1, 1)',
			  confirmButtonText: 'Play',
			  backdrop: `
				rgba(133, 1, 1,0.4)
			  `
			}).then((result) => {
			  /* Read more about isConfirmed, isDenied below */
			  if (result.isConfirmed) {
				drawIt();
			  }
			})
		}
	</script>
	<div id="head">SCREAM The Bricks</div><br>
	<div id="gameField">
		<canvas id="game" width="850" height="550"></canvas>
		<script type="text/javascript">
			function drawIt() {
			var x = 300;
			var y = 225;
			var dx = 2;
			var dy = 4;
			var r= 35;
			var ctx;
			var canvas;
			var points;

			var paddlex;
			var paddleh;
			var paddlew;
			
			var smshB=document.getElementById("brickSmash"); 


			function init_paddle() {
			  paddlex = 850 / 2;
			  paddleh = 20;
			  paddlew = 100;
			}
			function init() {
			canvas=document.getElementById("game");
			ctx = canvas.getContext('2d');
			return setInterval(draw, 12); 
			}

			
			var rightDown = false;
			var leftDown = false;
			
			function onKeyDown(evt) {
			  if (evt.keyCode == 39)
				rightDown = true;
			  else if (evt.keyCode == 37) 
			  	leftDown = true;
			}
			
			function onKeyUp(evt) {
			  if (evt.keyCode == 39)
			rightDown = false;
			  else if (evt.keyCode == 37) 
			  	leftDown = false;
			}
			$(document).keydown(onKeyDown);
			$(document).keyup(onKeyUp); 

			var bricks;
			var NROWS;
			var NCOLS;
			var BRICKWIDTH;
			var BRICKHEIGHT;
			var PADDING;
			var rowheight;
			var colheight;
			var row;
			var col;

			function initbricks() { //inicializacija opek - polnjenje v tabelo
			  NROWS = 7;
			  NCOLS = 5;
			  BRICKWIDTH = (850/NCOLS) - 5.5;
			  BRICKHEIGHT = 15;
			  PADDING = 5;
			  bricks = new Array(NROWS);
			  for (i=0; i < NROWS; i++) {
			    bricks[i] = new Array(NCOLS);
			    for (j=0; j < NCOLS; j++) {
			      bricks[i][j] = 1;
			    }
			  }
			}

			function draw() {
			ctx.beginPath();
			ctx.clearRect(0,0,850,550);
			
			//Slika za Brickse
			img = new Image();
    		img.src = 'img/GFBallV4.png';
			ctx.drawImage(img, x, y);
			
			//Plošček
			ctx.rect(paddlex, 550-paddleh, paddlew, paddleh);
			ctx.fill();
			ctx.stroke();
			
			//riši opeke
			for (i=0; i < NROWS; i++) {
				for (j=0; j < NCOLS; j++) {
					if (bricks[i][j] == 1) {
						ctx.rect(j * (BRICKWIDTH + PADDING) + PADDING, i * (BRICKHEIGHT + PADDING) + PADDING,BRICKWIDTH, BRICKHEIGHT);
						ctx.fill();
						ctx.stroke();
					}
				}
			}
			
			  rowheight = BRICKHEIGHT + PADDING; //Smo zadeli opeko?
			  colwidth = BRICKWIDTH + PADDING;
		      row = Math.floor(y/rowheight);
              col = Math.floor(x/colwidth);
			//Če smo zadeli opeko, vrni povratno kroglo in označi v tabeli, da opeke ni več
			if (y < NROWS * rowheight && row >= 0 && col >= 0 && bricks[row][col] == 1) {
			    smshB.play();
				dy = -dy; 
				bricks[row][col] = 0;
			} 
						
			if (x + dx > 850 || x + dx < 0+4)
    			dx = -dx;
			if (y + dy < 0+r)
    			dy = -dy;
  			else if (y + dy > 550-r) {
    			if (x > paddlex && x < paddlex + paddlew)
      				dy = -dy;
    			else
     				clearInterval(intervalId);
  				}

  				x += dx;
 			    y += dy;

 			    if (rightDown) paddlex += 5;
 				else if (leftDown) paddlex -= 5;
  				ctx.rect(paddlex, 550-paddleh, paddlew, paddleh);
  				ctx.fill();
				ctx.stroke();
				  if (x + dx > 850 -r || x + dx < 0 +r)
				    dx = -dx;
				  if (y + dy < 0 +r)
				    dy = -dy;
				  else if (y + dy > 550 -r+paddleh) {
				    if (x > paddlex && x < paddlex + paddlew)
				      dy = -dy;
				    else if (y + dy > 550 -r)
				      clearInterval(intervalId);
				  }
				 	
			}
			init();
			init_paddle();
			initbricks();
			}
			
		</script>
	</div>
</body>
</html>